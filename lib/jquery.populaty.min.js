/*!
 * jQuery Populaty - A Form Populator
 *
 * Licensed under The MIT License
 *
 * @version        0.1.0
 * @author         Washington Botelho
 * @documentation  wbotelhos.com/populaty
 *
 */

;(function(b){var a={init:function(c){return this.each(function(){if(c&&c.json){b.extend(c.json,b.fn.populaty.defaults.json);}this.opt=b.extend({},b.fn.populaty.defaults,c);var d=this;if(!d.opt.json){return;}if(d.opt.reset){d.reset();}d.fields=a._fields.call(d);d.opt.json=a._json.call(d);d.fields.each(function(){a._seek.call(d,this);});b(d).data({settings:d.opt,populaty:true});});},_apply:function(f,e){if(a._is(f,this.opt.typeful)){f.value=e;}else{if(a._is(f,this.opt.checkable)){a._markWith("checked",f,e);}else{if(a._is(f,this.opt.selectable)){var c=b(f).children();for(var d=0;d<c.length;d++){a._markWith("selected",c[d],e);}}}}a._triggerEvents(f);},_compact:function(d){for(var c=0;c<d.length;c++){if(!d[c]){d.splice(c--,1);}}return d;},_extract:function(f){var g=(f.name||"").split("."),c=[];for(var e in g){var d=g[e].split(/\[([\w]*)\]/);d=a._compact(d);c=c.concat(d);}return c.length?c:g;},_fields:function(){return b(this).find(this.opt.include).not(this.opt.exclude);},_is:function(d,c){return b.inArray(d.type,c)>=0;},_json:function(){var c=this.opt.json;return(typeof c==="string")?JSON.parse(c):c;},_markWith:function(f,e,d){var c=b(e);if(e.value==d){if(e.type!=="select-multiple"){c.val(d);}c.prop(f,f);}},_seek:function(f){var d=this,e=a._extract(f);(function c(l,n){for(var g=0;g<n.length;g++){l=l[n[g]];if(!l){break;}if(typeof l==="object"){if(l instanceof Array){for(var j in l){var k=l[j],h=/[\d]/.test(n[g+1])?2:1,m=n.slice(g+h,n.length);if(typeof k==="object"){c(k,m);}else{a._apply.call(d,f,k);}}g=n.length;}}else{a._apply.call(d,f,l);}}})(d.opt.json,e);},_triggerEvents:function(g){var f=b(g),e=f.data("events");if(e){if(e.click){f.triggerHandler("click");}if(e.change){f.triggerHandler("change");}}var d=g.onclick,c=g.onchange;if(d){d.call(g);}if(c){c.call(g);}}};b.fn.populaty=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments);}else{b.error("Method "+c+" does not exist!");}}};b.fn.populaty.defaults={checkable:["checkbox","radio"],exclude:":submit, :reset, :button",include:":input",json:undefined,reset:true,selectable:["select-one","select-multiple"],typeful:["text","textarea"]};})(jQuery);
