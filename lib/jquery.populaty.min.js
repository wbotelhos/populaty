/*!
 * jQuery Populaty - A Form Populator
 *
 * Licensed under The MIT License
 *
 * @version        0.1.1
 * @author         Washington Botelho
 * @documentation  wbotelhos.com/populaty
 *
 */

;(function(b){var a={init:function(c){return this.each(function(){if(c&&c.json){b.extend(c.json,b.fn.populaty.defaults.json);}this.opt=b.extend({},b.fn.populaty.defaults,c);var d=this;if(!d.opt.json){return;}if(d.opt.reset){d.reset();}d.fields=a._fields.call(d);d.opt.json=a._json.call(d);d.fields.each(function(){a._seek.call(d,this);});b(d).data({settings:d.opt,populaty:true});});},_apply:function(f,e){if(a._is(f,this.opt.typeful)){f.value=e;}else{if(a._is(f,this.opt.checkable)){a._markWith("checked",f,e);}else{if(a._is(f,this.opt.selectable)){var c=b(f).children();for(var d=0;d<c.length;d++){a._markWith("selected",c[d],e);}}}}a._triggerEvents(f);},_compact:function(d){for(var c=0;c<d.length;c++){if(!d[c]){d.splice(c--,1);}}return d;},_extract:function(f){var g=(f.name||"").split("."),c=[];for(var e in g){var d=g[e].split(/\[([\w]*)\]/);d=a._compact(d);c=c.concat(d);}return c.length?c:g;},_fields:function(){return b(this).find(this.opt.include).not(this.opt.exclude);},_is:function(d,c){return b.inArray(d.type,c)>=0;},_json:function(){var c=this.opt.json;return(typeof c==="string")?JSON.parse(c):c;},_markWith:function(f,e,d){d=d&&d.toString();if(e.value==d){var c=b(e);if(e.type!=="select-multiple"){c.val(d);}c.prop(f,f);}},_seek:function(f){var d=this,e=a._extract(f);(function c(m,n){for(var h=0;h<n.length;h++){m=m[n[h]];if(!m){break;}if(typeof m==="object"){if(m instanceof Array){for(var k in m){var l=m[k],j=/[\d]/.test(n[h+1])?2:1,g=n.slice(h+j);if(typeof l==="object"){c(l,g);}else{a._apply.call(d,f,l);}}break;}}else{a._apply.call(d,f,m);}}})(d.opt.json,e);},_triggerEvents:function(g){var f=b(g),e=f.data("events");if(e){if(e.click){f.triggerHandler("click");}if(e.change){f.triggerHandler("change");}}var d=g.onclick,c=g.onchange;if(d){d.call(g);}if(c){c.call(g);}}};b.fn.populaty=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments);}else{b.error("Method "+c+" does not exist!");}}};b.fn.populaty.defaults={checkable:["checkbox","radio"],exclude:":submit, :reset, :button",include:":input",json:undefined,reset:true,selectable:["select-one","select-multiple"],typeful:["text","textarea"]};})(jQuery);
